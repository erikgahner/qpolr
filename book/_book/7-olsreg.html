<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Quantitative Politics with R</title>
  <meta name="description" content="Quantitative Politics with R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Quantitative Politics with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Quantitative Politics with R" />
  
  
  

<meta name="author" content="Erik Gahner Larsen and Zoltán Fazekas">


<meta name="date" content="2018-11-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="6-dataviz.html">
<link rel="next" href="8-references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why <code>R</code>?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing <code>R</code></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages"><i class="fa fa-check"></i><b>1.4</b> Installing <code>R</code> packages</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#errors-and-help"><i class="fa fa-check"></i><b>1.5</b> Errors and help</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-basics.html"><a href="2-basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="2-basics.html"><a href="2-basics.html#numbers-as-data"><i class="fa fa-check"></i><b>2.1</b> Numbers as data</a></li>
<li class="chapter" data-level="2.2" data-path="2-basics.html"><a href="2-basics.html#missing-values-na"><i class="fa fa-check"></i><b>2.2</b> Missing values (<code>NA</code>)</a></li>
<li class="chapter" data-level="2.3" data-path="2-basics.html"><a href="2-basics.html#logical-operators"><i class="fa fa-check"></i><b>2.3</b> Logical operators</a></li>
<li class="chapter" data-level="2.4" data-path="2-basics.html"><a href="2-basics.html#text-as-data"><i class="fa fa-check"></i><b>2.4</b> Text as data</a></li>
<li class="chapter" data-level="2.5" data-path="2-basics.html"><a href="2-basics.html#data-frames"><i class="fa fa-check"></i><b>2.5</b> Data frames</a></li>
<li class="chapter" data-level="2.6" data-path="2-basics.html"><a href="2-basics.html#import-and-export-data-frames"><i class="fa fa-check"></i><b>2.6</b> Import and export data frames</a></li>
<li class="chapter" data-level="2.7" data-path="2-basics.html"><a href="2-basics.html#environment"><i class="fa fa-check"></i><b>2.7</b> Environment</a></li>
</ul></li>
<li class="part"><span><b>I Working with data</b></span></li>
<li class="chapter" data-level="3" data-path="3-data.html"><a href="3-data.html"><i class="fa fa-check"></i><b>3</b> Data management</a><ul>
<li class="chapter" data-level="3.1" data-path="3-data.html"><a href="3-data.html#selecting-variables-select"><i class="fa fa-check"></i><b>3.1</b> Selecting variables: <code>select()</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-data.html"><a href="3-data.html#selecting-observations-filter"><i class="fa fa-check"></i><b>3.2</b> Selecting observations: <code>filter()</code></a></li>
<li class="chapter" data-level="3.3" data-path="3-data.html"><a href="3-data.html#sorting-observations-arrange"><i class="fa fa-check"></i><b>3.3</b> Sorting observations: <code>arrange()</code></a></li>
<li class="chapter" data-level="3.4" data-path="3-data.html"><a href="3-data.html#rename-variables-rename"><i class="fa fa-check"></i><b>3.4</b> Rename variables: <code>rename()</code></a></li>
<li class="chapter" data-level="3.5" data-path="3-data.html"><a href="3-data.html#create-variables-mutate"><i class="fa fa-check"></i><b>3.5</b> Create variables: <code>mutate()</code></a></li>
<li class="chapter" data-level="3.6" data-path="3-data.html"><a href="3-data.html#the-pipe-operator"><i class="fa fa-check"></i><b>3.6</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.7" data-path="3-data.html"><a href="3-data.html#running-functions-on-variables-apply"><i class="fa fa-check"></i><b>3.7</b> Running functions on variables: <code>apply()</code></a></li>
<li class="chapter" data-level="3.8" data-path="3-data.html"><a href="3-data.html#aggregating-variables-summarize-and-group_by"><i class="fa fa-check"></i><b>3.8</b> Aggregating variables: <code>summarize()</code> and <code>group_by()</code></a></li>
<li class="chapter" data-level="3.9" data-path="3-data.html"><a href="3-data.html#recoding-variables-recode"><i class="fa fa-check"></i><b>3.9</b> Recoding variables: <code>recode()</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-datadownload.html"><a href="4-datadownload.html"><i class="fa fa-check"></i><b>4</b> Get existing data</a><ul>
<li class="chapter" data-level="4.1" data-path="4-datadownload.html"><a href="4-datadownload.html#using-data-from-data-packages"><i class="fa fa-check"></i><b>4.1</b> Using data from data packages</a></li>
<li class="chapter" data-level="4.2" data-path="4-datadownload.html"><a href="4-datadownload.html#download-data-from-webpages"><i class="fa fa-check"></i><b>4.2</b> Download data from webpages</a></li>
<li class="chapter" data-level="4.3" data-path="4-datadownload.html"><a href="4-datadownload.html#data-european-social-survey-essurvey"><i class="fa fa-check"></i><b>4.3</b> Data: European Social Survey (<code>essurvey</code>)</a></li>
<li class="chapter" data-level="4.4" data-path="4-datadownload.html"><a href="4-datadownload.html#data-manifesto-project-dataset-manifestor"><i class="fa fa-check"></i><b>4.4</b> Data: Manifesto Project Dataset (<code>manifestoR</code>)</a></li>
<li class="chapter" data-level="4.5" data-path="4-datadownload.html"><a href="4-datadownload.html#data-varieties-of-democracy-vdem"><i class="fa fa-check"></i><b>4.5</b> Data: Varieties of Democracy (<code>vdem</code>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-create.html"><a href="5-create.html"><i class="fa fa-check"></i><b>5</b> Create data</a><ul>
<li class="chapter" data-level="5.1" data-path="5-create.html"><a href="5-create.html#create-data-from-files"><i class="fa fa-check"></i><b>5.1</b> Create data from files</a></li>
<li class="chapter" data-level="5.2" data-path="5-create.html"><a href="5-create.html#scrape-data-from-tables"><i class="fa fa-check"></i><b>5.2</b> Scrape data from tables</a></li>
<li class="chapter" data-level="5.3" data-path="5-create.html"><a href="5-create.html#scrape-political-speeches"><i class="fa fa-check"></i><b>5.3</b> Scrape political speeches</a></li>
<li class="chapter" data-level="5.4" data-path="5-create.html"><a href="5-create.html#get-data-from-twitter"><i class="fa fa-check"></i><b>5.4</b> Get data from Twitter</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-create.html"><a href="5-create.html#data-on-twitter-user"><i class="fa fa-check"></i><b>5.4.1</b> Data on Twitter user</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-create.html"><a href="5-create.html#data-on-trends"><i class="fa fa-check"></i><b>5.4.2</b> Data on trends</a></li>
<li class="chapter" data-level="5.4.3" data-path="5-create.html"><a href="5-create.html#data-on-tweets"><i class="fa fa-check"></i><b>5.4.3</b> Data on tweets</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Presenting data</b></span></li>
<li class="chapter" data-level="6" data-path="6-dataviz.html"><a href="6-dataviz.html"><i class="fa fa-check"></i><b>6</b> Data visualisation</a><ul>
<li class="chapter" data-level="6.1" data-path="6-dataviz.html"><a href="6-dataviz.html#the-basics-of-ggplot2"><i class="fa fa-check"></i><b>6.1</b> The basics of <code>ggplot2</code></a><ul>
<li class="chapter" data-level="6.1.1" data-path="3-data.html"><a href="3-data.html#data"><i class="fa fa-check"></i><b>6.1.1</b> Data</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-dataviz.html"><a href="6-dataviz.html#aesthetics"><i class="fa fa-check"></i><b>6.1.2</b> Aesthetics</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-dataviz.html"><a href="6-dataviz.html#geometric-objects"><i class="fa fa-check"></i><b>6.1.3</b> Geometric objects</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-dataviz.html"><a href="6-dataviz.html#theme-adjustments"><i class="fa fa-check"></i><b>6.1.4</b> Theme adjustments</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-dataviz.html"><a href="6-dataviz.html#plotting-one-variable-distributions"><i class="fa fa-check"></i><b>6.2</b> Plotting one variable: distributions</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-dataviz.html"><a href="6-dataviz.html#bar-plot"><i class="fa fa-check"></i><b>6.2.1</b> Bar plot</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-dataviz.html"><a href="6-dataviz.html#histograms"><i class="fa fa-check"></i><b>6.2.2</b> Histograms</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-dataviz.html"><a href="6-dataviz.html#density-plots"><i class="fa fa-check"></i><b>6.2.3</b> Density plots</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-dataviz.html"><a href="6-dataviz.html#plotting-two-variables-relationships"><i class="fa fa-check"></i><b>6.3</b> Plotting two variables: relationships</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-dataviz.html"><a href="6-dataviz.html#box-plot"><i class="fa fa-check"></i><b>6.3.1</b> Box plot</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-dataviz.html"><a href="6-dataviz.html#scatter-plots"><i class="fa fa-check"></i><b>6.3.2</b> Scatter plots</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-dataviz.html"><a href="6-dataviz.html#line-plots"><i class="fa fa-check"></i><b>6.3.3</b> Line plots</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-dataviz.html"><a href="6-dataviz.html#manipulating-plots"><i class="fa fa-check"></i><b>6.4</b> Manipulating plots</a><ul>
<li class="chapter" data-level="6.4.1" data-path="6-dataviz.html"><a href="6-dataviz.html#themes"><i class="fa fa-check"></i><b>6.4.1</b> Themes</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-dataviz.html"><a href="6-dataviz.html#colours"><i class="fa fa-check"></i><b>6.4.2</b> Colours</a></li>
<li class="chapter" data-level="6.4.3" data-path="6-dataviz.html"><a href="6-dataviz.html#labels"><i class="fa fa-check"></i><b>6.4.3</b> Labels</a></li>
<li class="chapter" data-level="6.4.4" data-path="6-dataviz.html"><a href="6-dataviz.html#axes"><i class="fa fa-check"></i><b>6.4.4</b> Axes</a></li>
<li class="chapter" data-level="6.4.5" data-path="6-dataviz.html"><a href="6-dataviz.html#confidence-intervals"><i class="fa fa-check"></i><b>6.4.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="6.4.6" data-path="6-dataviz.html"><a href="6-dataviz.html#making-multiple-plots-in-one"><i class="fa fa-check"></i><b>6.4.6</b> Making multiple plots in one</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-dataviz.html"><a href="6-dataviz.html#saving-plots"><i class="fa fa-check"></i><b>6.5</b> Saving plots</a></li>
</ul></li>
<li class="part"><span><b>III Regression</b></span></li>
<li class="chapter" data-level="7" data-path="7-olsreg.html"><a href="7-olsreg.html"><i class="fa fa-check"></i><b>7</b> OLS regression</a><ul>
<li class="chapter" data-level="7.1" data-path="7-olsreg.html"><a href="7-olsreg.html#bivariate-linear-regression"><i class="fa fa-check"></i><b>7.1</b> Bivariate linear regression</a></li>
<li class="chapter" data-level="7.2" data-path="7-olsreg.html"><a href="7-olsreg.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.3" data-path="7-olsreg.html"><a href="7-olsreg.html#diagnostic-tests"><i class="fa fa-check"></i><b>7.3</b> Diagnostic tests</a></li>
<li class="chapter" data-level="7.4" data-path="7-olsreg.html"><a href="7-olsreg.html#setting-up-regression-tables"><i class="fa fa-check"></i><b>7.4</b> Setting up regression tables</a><ul>
<li class="chapter" data-level="7.4.1" data-path="7-olsreg.html"><a href="7-olsreg.html#exporting-the-regression-table"><i class="fa fa-check"></i><b>7.4.1</b> Exporting the regression table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-references.html"><a href="8-references.html"><i class="fa fa-check"></i><b>8</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Politics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="olsreg" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> OLS regression</h1>
<p>To provide a simple example of how to conduct an OLS regression, we will use the same data as in the visualisation chapter, i.e. the <code>states</code> data frame from the package <code>poliscidata</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;poliscidata&quot;</span>)

states &lt;-<span class="st"> </span>states</code></pre></div>
<div id="bivariate-linear-regression" class="section level2">
<h2><span class="header-section-number">7.1</span> Bivariate linear regression</h2>
<p>To conduct a bivariate linear regression, we use the <code>lm()</code> function (short for linear models). We need to specify the dependent variable, independent variable and the data frame. Below we specify <code>obama2012</code> as the dependent variable and <code>abort_rate08</code> as the independent variable. Notice that we use the <code>~</code> symbol to separate the dependent variable from the independent variable. We save the output in the object <code>reg_obama</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama &lt;-<span class="st"> </span><span class="kw">lm</span>(obama2012 <span class="op">~</span><span class="st"> </span>abort_rate08, <span class="dt">data =</span> states)</code></pre></div>
<p>If we type <code>reg_obama</code>, we can see the intercept and coefficient in the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama</code></pre></div>
<pre><code>
Call:
lm(formula = obama2012 ~ abort_rate08, data = states)

Coefficients:
 (Intercept)  abort_rate08  
     35.2589        0.8257  </code></pre>
<p>Here we see that the intercept is 35.26, which is the predicted vote share for Obama in 2012 when we extrapolate to a state with an abortion rate of 0. The coefficient is 0.83, which is the increase in the vote share for Obama when there is an one-unit increase in the abortion rate.</p>
<p>However, this is not enough information. We need, for example, also information on the standard errors as well as model statistics. To get this, we use the function <code>summary()</code> on our object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(reg_obama)</code></pre></div>
<pre><code>
Call:
lm(formula = obama2012 ~ abort_rate08, data = states)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1208  -5.6516   0.6785   4.7242  20.9904 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   35.2589     2.2970  15.350  &lt; 2e-16 ***
abort_rate08   0.8257     0.1297   6.366 6.91e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 7.654 on 48 degrees of freedom
Multiple R-squared:  0.4578,    Adjusted R-squared:  0.4465 
F-statistic: 40.52 on 1 and 48 DF,  p-value: 6.912e-08</code></pre>
<p>Here we can see that the estimate for <code>abort_rate08</code> is statistically significant. We can further see that the R-squared is 0.46 which indicates that 46% of the variation in the vote share is explained by our independent variable.</p>
<p>To convert the results from our analysis into a data frame, we can use the package <code>broom</code> <span class="citation">(Robinson, 2018)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)</code></pre></div>
<p>As a first example, we can save the estimates and test statistics in a data frame by using the function <code>tidy()</code>. We save the output in a new object <code>reg_obama_tidy</code> and show this output as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_tidy &lt;-<span class="st"> </span><span class="kw">tidy</span>(reg_obama)

reg_obama_tidy</code></pre></div>
<pre><code>          term  estimate std.error statistic      p.value
1  (Intercept) 35.258869 2.2970329 15.349745 3.818291e-20
2 abort_rate08  0.825655 0.1297048  6.365649 6.911913e-08</code></pre>
<p>If we would also like to have the confidence intervals, we can add the <code>conf.int = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_tidy &lt;-<span class="st"> </span><span class="kw">tidy</span>(reg_obama, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

reg_obama_tidy</code></pre></div>
<pre><code>          term  estimate std.error statistic      p.value   conf.low
1  (Intercept) 35.258869 2.2970329 15.349745 3.818291e-20 30.6403753
2 abort_rate08  0.825655 0.1297048  6.365649 6.911913e-08  0.5648661
  conf.high
1 39.877364
2  1.086444</code></pre>
<p>This is useful if you would like to visualise the results. However, often we also want to save predictions and residuals based on our model. To do this, we can use the function <code>augment()</code>. Below we save the output in the object <code>reg_obama_aug</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_aug &lt;-<span class="st"> </span><span class="kw">augment</span>(reg_obama)</code></pre></div>
<p>To see the data in the new object, use <code>head()</code>. Here you see that there is a variable called <code>.fitted</code>. This variable is the predicted value for each observation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(reg_obama_aug)</code></pre></div>
<pre><code>  obama2012 abort_rate08  .fitted  .se.fit    .resid       .hat   .sigma
1     40.81         12.0 45.16673 1.179911 -4.356729 0.02376297 7.708398
2     38.36         12.0 45.16673 1.179911 -6.806729 0.02376297 7.669635
3     36.88          8.7 42.44207 1.406179 -5.562068 0.03375074 7.691025
4     44.45         15.2 47.80882 1.083835 -3.358825 0.02005065 7.719335
5     60.19         27.6 58.04695 1.893732  2.143053 0.06121236 7.728453
6     51.45         15.7 48.22165 1.082515  3.228348 0.02000184 7.720544
      .cooksd .std.resid
1 0.004039088 -0.5760815
2 0.009859143 -0.9000401
3 0.009544419 -0.7392523
4 0.002010333 -0.4432886
5 0.002722341  0.2889684
6 0.001852473  0.4260579</code></pre>
<p>We can use this data frame to visualise the residuals (with the colour red below).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(reg_obama_aug, <span class="kw">aes</span>(<span class="dt">x=</span>abort_rate08, <span class="dt">y=</span>obama2012)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">xend=</span>abort_rate08, <span class="dt">y=</span>obama2012, <span class="dt">yend=</span>.fitted), 
        <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>abort_rate08, <span class="dt">y=</span>.fitted)) </code></pre></div>
<p><img src="qpolr_files/figure-html/unnamed-chunk-195-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">7.2</span> Multiple linear regression</h2>
<p>To conduct a multiple linear regression, we simply need to add an extra variable to our model. Accordingly, the only difference between the example above and the example here is the addition of a new variable. Here, we want to examine whether the effect of <code>abort_rate08</code> holds when we control for population density (<code>density</code>). Notice that we add a <code>+</code> before adding the variable to the list of variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_full &lt;-<span class="st"> </span><span class="kw">lm</span>(obama2012 <span class="op">~</span><span class="st"> </span>abort_rate08 <span class="op">+</span><span class="st"> </span>density, <span class="dt">data =</span> states)</code></pre></div>
<p>We use the <code>summary()</code> function to get the output of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(reg_obama_full)</code></pre></div>
<pre><code>
Call:
lm(formula = obama2012 ~ abort_rate08 + density, data = states)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1719  -5.5567  -0.2101   4.3195  21.5132 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  36.019160   2.328169  15.471  &lt; 2e-16 ***
abort_rate08  0.681420   0.161482   4.220 0.000111 ***
density       0.007656   0.005214   1.468 0.148669    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 7.564 on 47 degrees of freedom
Multiple R-squared:  0.4815,    Adjusted R-squared:  0.4595 
F-statistic: 21.83 on 2 and 47 DF,  p-value: 1.976e-07</code></pre>
<p>In the output we see that the coefficient for <code>abort_rate08</code> is slightly smaller compared to the bivariate model but still statistically significant. Again we can use the <code>tidy()</code> function to get a data frame with the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_full_tidy &lt;-<span class="st"> </span><span class="kw">tidy</span>(reg_obama_full)</code></pre></div>
<p>We further calculate the 95% confidence intervals for the estimates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_full_tidy &lt;-<span class="st"> </span>reg_obama_full_tidy <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">ci_low =</span> estimate <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>std.error,
    <span class="dt">ci_high =</span> estimate <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>std.error
  ) </code></pre></div>
<p>We can then visualise the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(reg_obama_full_tidy, <span class="kw">aes</span>(estimate, term, <span class="dt">xmin =</span> ci_low, 
                                <span class="dt">xmax =</span> ci_high, <span class="dt">height =</span> <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_errorbarh</span>()</code></pre></div>
<p><img src="qpolr_files/figure-html/unnamed-chunk-200-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In some cases the intercept is not relevant. In the code below, we use the <code>filter()</code> function to visualise all effects except for the intercept.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_obama_full_tidy <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(term <span class="op">!=</span><span class="st"> &quot;(Intercept)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(estimate, term, <span class="dt">xmin =</span> ci_low, 
             <span class="dt">xmax =</span> ci_high, <span class="dt">height =</span> <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_errorbarh</span>()</code></pre></div>
<p><img src="qpolr_files/figure-html/unnamed-chunk-201-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="diagnostic-tests" class="section level2">
<h2><span class="header-section-number">7.3</span> Diagnostic tests</h2>
<p>To get diagnostic plots, we will use the <code>fortify()</code> function from <code>ggplot2</code>. This allows us to get the following variables realted to model fit statistics:</p>
<ol style="list-style-type: decimal">
<li><code>.hat</code>: Diagonal of the hat matrix</li>
<li><code>.sigma</code>: Estimate of residual standard deviation when corresponding observation is dropped from model</li>
<li><code>.cooksd</code>: Cooks distance, using <code>cooks.distance()</code></li>
<li><code>.fitted</code>: Fitted values of model</li>
<li><code>.resid</code>: Residuals</li>
<li><code>.stdresid</code>: Standardised residuals</li>
</ol>
<p>First, we use <code>fortify()</code> on our linear model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg_fortify &lt;-<span class="st"> </span><span class="kw">fortify</span>(reg_obama_full)</code></pre></div>
<p>To see how our residuals are in relation to our fitted values, we can plot <code>.fitted</code> and <code>.resid</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(reg_fortify, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Residuals vs. Fitted&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Residuals&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;Fitted values&quot;</span>)</code></pre></div>
<p><img src="qpolr_files/figure-html/unnamed-chunk-203-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To see whether our residuals are normally distributed, we create a normal Q-Q plot with the standardized residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(reg_fortify) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> .stdresid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_abline</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Standardized residuals&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>)</code></pre></div>
<p><img src="qpolr_files/figure-html/unnamed-chunk-204-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To estimate the influence of individual observations, we plot the Cook’s distance for each state.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(reg_fortify, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">seq_along</span>(.cooksd), <span class="dt">y =</span> .cooksd)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()  <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Cook&#39;s distance&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Cook&#39;s distance&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;Obs. number&quot;</span>)</code></pre></div>
<p><img src="qpolr_files/figure-html/unnamed-chunk-205-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="setting-up-regression-tables" class="section level2">
<h2><span class="header-section-number">7.4</span> Setting up regression tables</h2>
<p>To export regression tables from <code>R</code>, we are going to use the package <code>stargazer</code> (remember to install the package if you haven’t already done so).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;stargazer&quot;</span>)</code></pre></div>
<p>First, we use the <code>stargazer()</code> function to show the output from the object <code>reg_obama</code>. Notice that we also add the option <code>type = &quot;text&quot;</code>. If we do not do that, we will get the output as LaTeX code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(reg_obama, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>)</code></pre></div>
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                             obama2012         
-----------------------------------------------
abort_rate08                 0.826***          
                              (0.130)          
                                               
Constant                     35.259***         
                              (2.297)          
                                               
-----------------------------------------------
Observations                    50             
R2                             0.458           
Adjusted R2                    0.446           
Residual Std. Error       7.654 (df = 48)      
F Statistic           40.521*** (df = 1; 48)   
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>This shows the output from one regression model. To add more regression models to the table, simply add a comma and the name of the object with the model. Below we use the same code as above and add the model with control variables included, <code>reg_obama_full</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(reg_obama, reg_obama_full, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>)</code></pre></div>
<pre><code>
=================================================================
                                 Dependent variable:             
                    ---------------------------------------------
                                      obama2012                  
                             (1)                    (2)          
-----------------------------------------------------------------
abort_rate08               0.826***               0.681***       
                           (0.130)                (0.161)        
                                                                 
density                                            0.008         
                                                  (0.005)        
                                                                 
Constant                  35.259***              36.019***       
                           (2.297)                (2.328)        
                                                                 
-----------------------------------------------------------------
Observations                  50                     50          
R2                          0.458                  0.482         
Adjusted R2                 0.446                  0.459         
Residual Std. Error    7.654 (df = 48)        7.564 (df = 47)    
F Statistic         40.521*** (df = 1; 48) 21.827*** (df = 2; 47)
=================================================================
Note:                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<div id="exporting-the-regression-table" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Exporting the regression table</h3>
<p>To export the regression table, we use the option <code>out</code> to specify, where we want to save our regresion table. Below we save the table in the file <code>tab-regression.htm</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(reg_obama, reg_obama_full, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>,
          <span class="dt">out=</span><span class="st">&quot;tab-regression.htm&quot;</span>)</code></pre></div>
<p>An <code>.htm</code> file is a HTML file you can open in your browser (e.g. Google Chrome). To get it into Word, simply open the file via Word. You might have to do some extra changes before it is ready for a broader audience. Always try to make your tables look like tables in published articles and books.</p>

<!--
The bib chunk below must go last in this document according to how R Markdown renders.  More info is at http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
-->

<!-- 
If you'd like to change the name of the bibliography to something else,
delete "References" and replace it.
-->
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="6-dataviz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["qpolr.pdf", "PDF"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
